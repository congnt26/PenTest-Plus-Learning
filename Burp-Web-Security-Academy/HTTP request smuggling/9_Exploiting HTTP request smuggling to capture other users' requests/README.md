# Exploiting HTTP request smuggling to capture other users' requests
https://portswigger.net/web-security/request-smuggling/exploiting/lab-capture-other-users-requests

## Phân tích & resolve lab
- Phát hiện là CL.TE
- Như tiêu đề của lab, mục đích bài này là tận dụng smuggling technique để in ra data từ 1 request khác (có thể đến từ user 1, user 2, hoặc là admin) trong comment của mình thêm vào bài post.
- Data này nếu đến từ 1 user khác (trong lab là administrator), có thể chứa session cookie và ta có thể dùng session này để login mà ko cần đến password.
- Check post comment req
![img.png](img.png)
![img_1.png](img_1.png)
- Smuggle post comment request trong 1 POST attack req như sau
  - Đưa `&comment=c1` ra cuối cùng mục đích để khi có other user's req tiếp theo, nó sẽ append vào `&comment` này, khi đó sẽ in other user's req ra trong comment
  - CL = CL của normal GET req (thử tưởng tượng nó là GET req của other user) + CL của post comment
  - Như hình thì 90 + 843 = 933

![img_2.png](img_2.png)

- Do đó ta gởi attack req

![img_3.png](img_3.png)

- Gởi tiếp normal req : 200 OK - yeah, check comment trên web xem có info của other user ko.
![img_4.png](img_4.png)
  - NOTE: sẽ không thấy response của user khác ngay lập tức (vì chúng ta đang chờ để bắt các response, nhưng response gởi ngẫu nhiên từ server).
- Do đó, ta gởi liên tục vài req mới có thể thấy response cần thiết.
- Có info của user khác rồi

![img_6.png](img_6.png)

- Update lại cookie trực tiếp trên chrome và refresh
![img_7.png](img_7.png)

- **Chú ý:** có thể sẽ thấy khi gởi normal req bị timeout như hình
![img_5.png](img_5.png)
  - Nguyên nhân do vượt quá maximum CL: "actual_content_length + length of content of our own normal request or a victim's normal request". --> xem lại lab2
