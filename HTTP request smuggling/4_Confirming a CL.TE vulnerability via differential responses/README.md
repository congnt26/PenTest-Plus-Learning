# Lab: Confirming a CL.TE vulnerability via differential responses – HTTP Request Smuggling
https://portswigger.net/web-security/request-smuggling/finding/lab-confirming-cl-te-via-differential-responses

## Phân tích

- Trong [CL.TE lab](../../HTTP%20request%20smuggling/1_HTTP%20request%20smuggling,%20basic%20CL.TE%20vulnerability/README.md) trước, ta có đề cập kĩ thuật phát hiện CL.TE (timeout)
- Xem diagram dưới đây cho lab này

![img.png](img.png)

- Trong request dưới đây, do FE dùng CL (mà CL=41 : đúng) nên được forward xuống BE
- BE nhận payload, thấy có chunk=0 (end of chunked message) nên exploit GET request (`GET /throws404` ...) được add như là prefix cho request kế tiếp
- Lưu ý: Header `X-Ignore: X`
  - Không có /r/n để make sure request kế tiếp sẽ nối tiếp vào exploit GET request (prefix) trước đó
  - Nếu có /r/n thì nó sẽ có 2 GET req trong 1 message thì sẽ bị invalid req.
  - Có thể xài any header, vd: `Foo: Bar`, miễn là ko có `/r/n` ở cuối.

## Resolve lab

- Attack Request
![img_1.png](img_1.png)

- Normal request
![img_2.png](img_2.png)

Nếu có `/r/n` ở cuối -> invalid request
![img_3.png](img_3.png)

![img_4.png](img_4.png)

![img_5.png](img_5.png)