# Exploiting HTTP request smuggling to bypass front-end security controls, CL.TE vulnerability
https://portswigger.net/web-security/request-smuggling/exploiting/lab-bypass-front-end-controls-cl-te

## Phân tích
- Dùng kĩ thuật ở lab1 để detect CL.TE
- Để ý rằng path /admin bị block
![img.png](img.png)

- Smuggle path /admin dùng CL.TE (note: ko có `/r/n` sau header Foo để request sau append vào req này)
![img_1.png](img_1.png)
- Gởi tiếp 1 normal request
![img_2.png](img_2.png)
- Thấy "Admin interface only available to local users" ==> Dùng kĩ thuật Trick cho BE nghĩ rằng là chúng ta đang là local user bằng cách để Host header là `localhost`

Attack req
![img_3.png](img_3.png)
Normal req: "Duplicate header names are not allowed"
![img_4.png](img_4.png)

Bởi vì có 2 Host header chung 1 request sau khi exploit req gộp với normal request

![img_5.png](img_5.png)

## Solve lab

- Attack req
![img_6.png](img_6.png)

- Normal req -> thấy path /admin/delete?username=carlos
![img_7.png](img_7.png)

- Thử tiếp với path để delete carlos
![img_9.png](img_9.png)

Done
![img_8.png](img_8.png)