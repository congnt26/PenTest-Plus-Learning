- During my practicing some study cases, I found out the vulnerability‚Äôs issues related to our innovation.com.vn domain.
- The exploitation idea is based on Creative lab from tryhackme website. The write-up for my reference is https://medium.com/@niedhacker/creative-tryhackme-44a65eaee5d5

- Issues:
  - Vulnerbility 01: Wordpress username and password can be brute-forced. 
  - Vulnerbility 02: Wordpress xmlrpc.php vulnerabilities

- Now let‚Äôs go to see the PoC in each day:

## Day 01 (May 08): first idea starting and enumeration. 
-	Read https://medium.com/@niedhacker/creative-tryhackme-44a65eaee5d5 and practice on real lab ‚Äì Yes, I already finished it. (just follow steps)
-	Think about https://sgas.innovation.com.vn/ web. Can it be applied to gain access? ‚Äì Trying‚Ä¶
-	Check nmap port scan.
![img_1.png](img_1.png)

-	Try with vhost or sub-domain:
![img_2.png](img_2.png)

-	Nothing interesting. Think that it might not have any vhost/subdomain in sgas.innovation.com.vn. Let‚Äôs try with TLD innovation.com.vn
![img_3.png](img_3.png)

-	Hm, we can see tk subdomain (tk.innovation.com.vn), can we get any interesting thing here? Run nmap again!!
![img_4.png](img_4.png)

-	We can see too many interesting things here. Use the chrome to see if we can access on web port (80/443)
![img_5.png](img_5.png)

-	No, we cannot. Try with Burp
![img_6.png](img_6.png)

-	Well, we get 200 OK. Let follow above article to enumerate localhost port (run in Intruder and add port as a variable with Payload is number from 0 to 65535.
-	Note that this step is taking a long time to enumerate.
![img_7.png](img_7.png)

-	Finally, after a couple hours, it finished but nothing changes in Response.
![img_8.png](img_8.png)

-	Seems that this enumeration does not work. It‚Äôs not a lucky day. ‚òπ
-	Some useful harvested information:
     - A hidden tk vhost in innovation.com.vn
     - Port 80, 443 opened, they could be contained some vulnerabilities.
-	End day 01.

## Day 02 (May 9): WPScan and brute-force wordpress username/password

-	Scan nmap for this domain. We can see port 80 has Wordpress service is running.
![img_9.png](img_9.png)

-	Leverage WPScan to find more information. I refer to https://medium.com/@niedhacker/tryhack3m-bricks-heist-2024-592e203d2536
![img_10.png](img_10.png)

-	In the namp result, I see install.php file has a login page (wp-login.php)
![img_11.png](img_11.png)

![img_12.png](img_12.png)

-	Try to access with wp-login.php
![img_13.png](img_13.png)

-	I see a login form, investigate the form, I see that it needs log & pwd to login (it could be a username and password respectively). And it requires a POST method!!
![img_14.png](img_14.png)

-	Try with any username and password ÔÉ® not a valid one
![img_15.png](img_15.png)

-	Can we enumerate the username? Yes, WPScan supports scan this (use --enumerate u). Result is:
![img_16.png](img_16.png)


-	Great. It finds a tma user with its posts.
![img_17.png](img_17.png)

### Vulnerability 01: Enumerate user/pass of Wordpress successfully

-	Try to brute-force password with Intruder by wordlists. Failed as no password is accepted.
![img_18.png](img_18.png)

-	Let‚Äôs try with magic TMA password (12345678x@X). And interesting, I can login successfully üòä
![img_19.png](img_19.png)

-	End day 02.

## Day 03 (May 10): 
### Vulnerability 02: Wordpress xmlrpc.php vulnerabilities
-	In WPScan from day 02, I notice that xmlrpc.php is exposed.
![img_20.png](img_20.png)

![img_21.png](img_21.png)

-	Follow some tips to find xmlrpc.php vulnerabilities: https://ms-official5878.medium.com/xml-rpc-php-wordpress-vulnerabilities-9a7d66068bde
-	Try with system.listMethods.
![img_22.png](img_22.png)

-	To perform XSPA or Port Scanning we need to check what are the methods are supported by XML-RPC and mainly ‚Äúpingback.ping‚Äù is the one which is abused by attacker to launch XSPA or DDOS attacks. As we know ‚Äúpingback.ping‚Äù is enabled on XML-RPC server, then let‚Äôs proceed and try and get a ping back on our server, we can use netcat , or python server , nodejs server , or even the apache logs anything we want. I‚Äôll be using the webhook http-server as it needs to be reached from the internet.
![img_23.png](img_23.png)


-	Start server and send the following request in post data
![img_24.png](img_24.png)

-	Check log on server. We can see the log, this mean that our external server get a pingback message from server by using xmlprc.php.
![img_25.png](img_25.png)


-	Additionally, we can use user/pass from day-02 to login by  wp.getUserBlogs method.
![img_26.png](img_26.png)

-	For the mitigation, we can follow https://www.rosehosting.com/blog/what-is-wordpress-xml-rpc-and-how-to-stop-an-attack/
     - Disable Pingbacks
     - Prevent All Authentication Requests via XML-RPC
     - Disable Access to xmlrpc.php

